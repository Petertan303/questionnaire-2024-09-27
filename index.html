<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>霸凌总是令人心痛的……</title>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i&amp;display=swap">
    <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container mt-5">
        <h2 class="mb-4">霸凌</h2>

        <form id="survey-form">

            <div class="form-group">
                <label for="question1">（复选）遭受霸凌的时间？</label>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question1" id="question1_1" value="option1">
                    <label class="form-check-label" for="question1_1">学龄前</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question1" id="question1_2" value="option2">
                    <label class="form-check-label" for="question1_2">小学</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question1" id="question1_3" value="option3">
                    <label class="form-check-label" for="question1_3">初中</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question1" id="question1_4" value="option4">
                    <label class="form-check-label" for="question1_4">高中</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question1" id="question1_5" value="option5">
                    <label class="form-check-label" for="question1_5">高中之后</label>
                </div>
            </div>

            <div class="form-group">
                <label for="question2">（单选）遭受霸凌的程度？（1～5为愈发严重）</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_1" value="option1">
                    <label class="form-check-label" for="question2_1">1</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_2" value="option2">
                    <label class="form-check-label" for="question2_2">2</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_3" value="option3">
                    <label class="form-check-label" for="question2_3">3</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_4" value="option4">
                    <label class="form-check-label" for="question2_4">4</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_5" value="option5">
                    <label class="form-check-label" for="question2_5">5</label>
                </div>
            </div>

            <div class="form-group">
                <label for="question3">（复选）遭受霸凌的时间？</label>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question3" id="question3_1" value="option1">
                    <label class="form-check-label" for="question3_1">学龄前</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question3" id="question3_2" value="option2">
                    <label class="form-check-label" for="question3_2">小学</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question3" id="question3_3" value="option3">
                    <label class="form-check-label" for="question3_3">初中</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question3" id="question3_4" value="option4">
                    <label class="form-check-label" for="question3_4">高中</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question3" id="question3_5" value="option5">
                    <label class="form-check-label" for="question3_5">高中之后</label>
                </div>
            </div>

            <div class="form-group">
                <label for="question4">（复选）遭受霸凌的形式？</label>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_1" value="option1">
                    <label class="form-check-label" for="question4_1">冷暴力（例如：集体孤立）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_2" value="option2">
                    <label class="form-check-label" for="question4_2">言语侮辱</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_3" value="option3">
                    <label class="form-check-label" for="question4_3">物理攻击</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_4" value="option4">
                    <label class="form-check-label" for="question4_4">干涉你的个人财产（例如，教科书、文具、玩具）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_5" value="option5">
                    <label class="form-check-label" for="question4_5">传谣</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_6" value="option6">
                    <label class="form-check-label" for="question4_6">胁迫、恐吓</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_7" value="option7">
                    <label class="form-check-label" for="question4_7">敲诈勒索（索要金钱、物件等）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_8" value="option8">
                    <label class="form-check-label" for="question4_8">传谣</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question4" id="question4_9" value="option9">
                    <label class="form-check-label" for="question4_9">网络欺凌</label>
                </div>
            </div>

            <div class="form-group">
                <label for="question5">（单选）霸凌者的数量？</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question5" id="question5_1" value="option1">
                    <label class="form-check-label" for="question5_1">单人</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question5" id="question5_2" value="option2">
                    <label class="form-check-label" for="question5_2">小团体（2～5人）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question5" id="question5_3" value="option3">
                    <label class="form-check-label" for="question5_3">中等规模团体（6～10人）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question5" id="question5_4" value="option4">
                    <label class="form-check-label" for="question5_4">较大规模（10人以上）</label>
                </div>
            </div>

            <div class="form-group">
                <label for="question6">（复选）霸凌者的身份？</label>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question6" id="question6_1" value="option1">
                    <label class="form-check-label" for="question6_1">同班级同学</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question6" id="question6_2" value="option2">
                    <label class="form-check-label" for="question6_2">同年级同学（不同班）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question6" id="question6_3" value="option3">
                    <label class="form-check-label" for="question6_3">同学校同学（不同年级）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question6" id="question6_4" value="option4">
                    <label class="form-check-label" for="question6_4">外校学生（不在同一学校）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question6" id="question6_5" value="option5">
                    <label class="form-check-label" for="question6_5">校外非学生人士（非学生的社会分子）</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="question6" id="question6_6" value="option6">
                    <label class="form-check-label" for="question6_6">校内非学生人士</label>
                </div>
            </div>


            <div class="form-group">
                <label for="question2">（单选）遭受霸凌的程度？（1～5为愈发严重）</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_1" value="option1">
                    <label class="form-check-label" for="question2_1">1</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_2" value="option2">
                    <label class="form-check-label" for="question2_2">2</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_3" value="option3">
                    <label class="form-check-label" for="question2_3">3</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_4" value="option4">
                    <label class="form-check-label" for="question2_4">4</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="question2" id="question2_5" value="option5">
                    <label class="form-check-label" for="question2_5">5</label>
                </div>
            </div>

            <div class="form-group">
                <label for="comments">后续是如何处理的？</label>
                <textarea class="form-control" type="comments" name="comments-1" rows="1" placeholder="谈谈你现在的处境，霸凌对你的影响、创伤，你想传递的呼吁，或是题目本身的疏漏之处......"></textarea>
            </div>

            <div class="form-group">
                <label for="comments">你想说的话......</label>
                <textarea class="form-control" type="comments" name="comments-2" rows="3" placeholder="谈谈你现在的处境，霸凌对你的影响、创伤，你想传递的呼吁，或是题目本身的疏漏之处......"></textarea>
            </div>

            <button type="submit" class="btn btn-primary">提交问卷</button>
        </form>

        <div id="survey-status" style="display: none;">
            <h4>问卷已提交！</h4>
        </div>
    </div>

    <script src="jquery-1.11.0.min.js"></script>
    <script>
        $(document).ready(function() {
            const apiBaseUrl = 'https://frp-few.top:57576/';

            $('#survey-form').on('submit', async function(event) {
                event.preventDefault();

                const response = await fetch('https://ip.011102.xyz/');
                const data = await response.json();
                const ip = data.IP.IP;
                const md5Ip = CryptoJS.MD5(ip).toString();

                const jsonData = {};
                const formElements = $(this).find(':input'); // 获取所有输入元素

                formElements.each(function() {
                    const name = $(this).attr('name');
                    const type = $(this).attr('type');

                    if (type === 'radio' && $(this).is(':checked')) {
                        jsonData[name] = $(this).val(); // 单选题
                    } else if (type === 'checkbox') {
                        if (!jsonData[name]) {
                            jsonData[name] = []; // 初始化数组
                        }
                        if ($(this).is(':checked')) {
                            jsonData[name].push($(this).val()); // 多选题
                        }
                    } else if (type === 'comments') {
                        jsonData[name] = $(this).val(); // 文本输入
                    }
                });

                jsonData.md5Ip = md5Ip;

                $.ajax({
                    url: `${apiBaseUrl}/submit_survey/`,
                    type: 'POST',
                    data: JSON.stringify(jsonData),
                    contentType: "application/json",
                    success: function(response) {
                        alert(response.message);
                        $('#survey-form').hide();
                        $('#survey-status').show();
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                        alert('提交失败，请重试。');
                    }
                });
            });
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
</body>

</html>